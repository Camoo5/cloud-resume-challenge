name: deploy_main
<<<<<<< HEAD
#Deploys when push is made from the frontend renamed main folder
=======
#Deploys when push is made from the frontend folder
>>>>>>> 3a79b3ea064598d3cd6fb3dde628f800a1c4f8d6
on:
    workflow_dispatch:
    push:
        branches: [main]
        paths:
        - 'main/**'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: login with azure
        uses: azure/login@v1
        with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}

      - name: Upload to blob storage
        uses: azure/CLI@v1
        with:
          azcliversion: 2.30.0
          inlineScript: |
            az storage blob upload-batch --account-name <azureresumewo> --auth-mode key -d '$web' -s main/

      - name: Purge CDN endpoint
        uses: azure/CLI@v1
        with:
          azcliversion: 2.30.0
          inlineScript: |
            az cdn endpoint purge --content-paths  "/*" --profile-name "azureresumeoo" --name "azureresumeoo" --resource-group "AzureResume-rg"

  # Azure logout
      - name: logout
        run: |
            az logout
<<<<<<< HEAD
        if: always()
=======
        if: always()
>>>>>>> 3a79b3ea064598d3cd6fb3dde628f800a1c4f8d6
